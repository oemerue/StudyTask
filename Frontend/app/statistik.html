<!doctype html>
<html lang="de">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Statistik – StudyTasks</title>

    <link rel="stylesheet" href="../src/styles.css" />
</head>

<body>

    <header class="site-header">
        <div class="container header-inner">
            <a class="brand" href="dashboard.html">
                <img src="../images/Logo.png" class="brand-logo" />
            </a>

            <nav class="nav">
                <ul class="nav-list">
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="aufgaben.html">Aufgaben</a></li>
                    <li><a href="kalender.html">Kalender</a></li>
                    <li><a href="gruppen.html">Gruppen</a></li>
                    <li><a href="statistik.html" class="active">Statistik</a></li>
                    <li><a href="logout.html">Logout</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="section">
        <div class="container" style="max-width:900px;">
            <h1 class="page-title">Aufgabenstatistik</h1>

            <div class="grid" style="margin-top:32px;">
                <div class="feature">
                    <h3>Gesamt</h3>
                    <p id="statTotal">–</p>
                </div>

                <div class="feature">
                    <h3>Offen</h3>
                    <p id="statTodo">–</p>
                </div>

                <div class="feature">
                    <h3>In Bearbeitung</h3>
                    <p id="statInProgress">–</p>
                </div>

                <div class="feature">
                    <h3>Erledigt</h3>
                    <p id="statDone">–</p>
                </div>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <p class="muted">© <span id="y"></span> StudyTasks</p>
    </footer>

    <script>
        document.getElementById("y").textContent = new Date().getFullYear();
    </script>

    <script src="js/auth-check.js"></script>
    <script src="js/api.js"></script>
    <script src="js/statistik.js"></script>

    <script>
        (async() => {
            const params = new URLSearchParams(window.location.search);
            const groupId = params.get("group_id");

            if (!groupId) {
                alert("Keine Gruppe ausgewählt");
                window.location.href = "gruppen.html";
                return;
            }

            try {
                const stats = await loadStatistics(groupId);

                document.getElementById("statTotal").textContent = stats.total;
                document.getElementById("statTodo").textContent = stats.todo;
                document.getElementById("statInProgress").textContent = stats.inProgress;
                document.getElementById("statDone").textContent = stats.done;
            } catch (e) {
                alert("Statistik konnte nicht geladen werden.");
                console.error(e);
            }
        })();
    </script>

    <script src="js/admin-nav.js"></script>


</body>

</html>